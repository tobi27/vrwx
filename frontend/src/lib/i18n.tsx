
import React, { createContext, useContext, useState } from 'react';

type Language = 'en' | 'zh';

export const translations = {
  en: {
    nav: {
      market: 'MARKET',
      quote: 'QUOTE',
      ledger: 'LEDGER',
      uplink: 'UPLINK',
      docs: 'DOCS',
      connect: 'CONNECT WALLET',
      status_live: 'LIVE_UPLINK',
      status_mock: 'DEMO_MODE (NO_BACKEND)',
      status_conn: 'CONNECTING...',
      login: 'ID_LOGIN',
      logout: 'DISCONNECT',
      profile: 'OPERATOR_ID',
    },
    auth: {
      title_login: 'IDENTITY_VERIFICATION',
      title_signup: 'NEW_OPERATOR_REGISTRY',
      email: 'COMMS_EMAIL',
      password: 'ACCESS_KEY',
      btn_login: 'ESTABLISH LINK',
      btn_signup: 'REGISTER UPLINK',
      toggle_login: 'Already have an ID? Login',
      toggle_signup: 'Need access? Apply for ID',
      error: 'ACCESS DENIED',
      success: 'LINK ESTABLISHED',
      loading: 'HANDSHAKING...',
    },
    hero: {
      badge: 'Protocol V2 is now live on Mainnet',
      title_1: 'Tokenize',
      title_2: 'Robotic Work.',
      subtitle: 'The settlement layer for autonomous agents. We verify physical outcomes cryptographically so you can buy results, not just rent hardware.',
      btn_connect: 'Connect Robot',
      btn_market: 'Explore Market',
      btn_docs: 'Developers / Protocol',
      stat_gmv: 'GMV (30d)',
      stat_active: 'Active Offers',
      stat_settled: 'Settlements',
      stat_security: 'Security',
      stat_uptime: 'SLA Uptime',
    },
    features: {
      title: 'Cryptographic Certainty',
      subtitle: 'Replace trust with mathematical proof.',
      card_1_title: 'Verified Execution',
      card_1_desc: 'Robots sign telemetry with secure enclave keys. ExecutionManifests are hashed and anchored on-chain for immutable history.',
      card_2_title: 'Liquid Receipts',
      card_2_desc: 'Completed jobs mint ERC-1155 tokens. These receipts are composable DeFi assets that can be factored, audited, or traded.',
      card_3_title: 'Service Primitives',
      card_3_desc: 'Standardized interfaces for Inspection, Patrol, and Delivery. Plug-and-play compatibility with any ROS-enabled hardware.',
    },
    live: {
      title: 'LIVE_SETTLEMENT_FEED.log',
      view_explorer: 'VIEW_EXPLORER',
    },
    cta: {
      title: 'Start buying outcomes.',
      subtitle: 'Join the network of autonomous operators and service buyers today.',
      btn_quote: 'Get a Quote',
      btn_docs: 'Read Documentation',
    },
    market: {
      title: 'GLOBAL MARKET',
      source_live: 'SOURCE: LIVE NODE',
      source_mock: 'SOURCE: MOCK DATA',
      tab_all: 'ALL',
      search_placeholder: 'SEARCH_COORDS...',
      col_id: 'ID',
      col_type: 'TYPE',
      col_loc: 'LOCATION',
      col_qual: 'QUALITY',
      col_price: 'PRICE',
      empty: 'NO OFFERS BROADCASTED ON NETWORK.',
      init: 'INITIALIZING DATA FEED...',
      btn_exec: 'EXECUTE',
    },
    connect: {
      title: 'HARDWARE UPLINK',
      subtitle: 'Universal connector protocol for autonomous assets.',
      section_onboard: 'PRODUCTION UPLINK',
      onboard_desc: 'Register a new fleet to generate production API keys.',
      fleet_name: 'FLEET DESIGNATION / CALLSIGN',
      btn_onboard: 'INITIALIZE & GENERATE KEYS',
      redirecting: 'REDIRECTING TO SECURE GATEWAY...',
      section_sim: 'UPLINK SIMULATOR (TESTNET)',
      endpoint_label: 'TARGET ENDPOINT (POST)',
      payload_label: 'PAYLOAD CONFIGURATION',
      btn_transmit: 'INITIATE SEQUENCE',
      btn_transmitting: 'TRANSMITTING...',
      terminal_title: 'TERMINAL_OUTPUT',
      log_init: '> System initialized...',
      log_wait: '> Waiting for payload...',
      log_encrypt: '> Encrypting packet... [OK]',
      log_handshake: '> Handshaking with VRWX Node...',
      log_upload: '> Uploading Telemetry...',
      log_confirm: '> 200 OK: CONFIRMED',
      log_mint: '> Receipt minted successfully.',
      log_close: '> Session closed.',
      signal_lock: 'SIGNAL LOCKED',
      no_carrier: 'NO CARRIER',
    },
    quote: {
      title: 'MISSION CONFIG',
      subtitle: 'Define parameters // Estimate cost // Deploy',
      step_1: '1. Select Service Type',
      step_2: '2. Job Parameters',
      label_zone: 'TARGET_ZONE',
      label_duration: 'DURATION (HRS)',
      label_sla: 'SLA_LEVEL',
      cost_title: 'Cost Analysis',
      wait_input: '[WAITING FOR INPUT]',
      total_est: 'Total Est.',
      base_rate: 'BASE_RATE',
      quality_mult: 'QUALITY_MULT',
      bonding_title: 'Escrow Bonding Required',
      bonding_desc: 'Stake: ${amount}. Returned upon outcome verification.',
      btn_sign: 'Sign & Deploy',
      btn_done: 'Offer On-Chain',
      offer_confirmed: 'TX: 0x9f...2a1 [CONFIRMED]',
      view_etherscan: 'VIEW_ETHERSCAN',
    },
    receipts: {
      title: 'Receipts Explorer',
      subtitle: 'Public ledger of all verified robotic outcomes.',
      btn_csv: 'Download CSV',
      col_token: 'Token ID',
      col_service: 'Service',
      col_op: 'Operator',
      col_time: 'Time',
      col_status: 'Status',
      col_val: 'Value',
      detail_return: 'Return to Explorer',
      detail_settlement: 'Settlement Value',
      detail_manifest: 'Execution Manifest',
      detail_proof: 'Cryptographic Proof',
      detail_chain: 'On-Chain Anchor (Immutable)',
      verify_btn: 'Recompute Hash & Verify',
      verify_hashing: '1/2 RECOMPUTING LOCAL HASH...',
      verify_server: '2/2 QUERYING ON-CHAIN NODE...',
      verify_success_title: 'Double Match Confirmed',
      verify_local_match: 'Local Recompute Match',
      verify_server_match: 'Server Validation OK',
      verify_reset: 'Reset Verifier',
    },
    community: {
      title: 'NETWORK STATUS',
      subtitle: 'Decentralized Operator Registry & Node Telemetry',
      label_gmv: 'Total Volume (GMV)',
      label_receipts: 'Total Receipts',
      stat_active: 'ACTIVE OFFERS',
      stat_active_sub: 'Live service listings',
      stat_dispute: 'DISPUTE RATE',
      stat_dispute_sub: 'Network health check',
      stat_uptime: 'UPTIME',
      stat_uptime_sub: 'Last 30 days',
      topology: 'GLOBAL_NODE_TOPOLOGY',
      sync_live: 'LIVE SYNC',
      sync_conn: 'CONNECTING',
    },
    docs: {
      title: 'Developer Hub',
      subtitle: 'Technical resources for integrating autonomous agents with the VRWX Settlement Protocol.',
      sdk_ref: 'SDK Reference',
      smart_contracts: 'Smart Contracts',
      core_concepts: 'Core Concepts',
      link_webhook: 'Webhook Integration',
      link_proof: 'Proof Verification',
      link_manifest: 'Service Manifests',
      api_key_title: 'Need an API Key?',
      api_key_desc: 'Access to the Mainnet Relay requires a staked operator account.',
      apply_access: 'Apply for Access',
      section_webhook: 'Webhook Integration',
      webhook_desc: 'Robots push job completion data to the VRWX Relay via a standard webhook. The Relay handles IPFS pinning and on-chain hashing (minting).',
      section_proof: 'Proof Verification',
      proof_desc: 'To verify a receipt without trusting the API, recompute the hash locally.',
      step_1: 'Fetch the canonical JSON from IPFS (via `manifestUrl`).',
      step_2: 'Sort object keys recursively (Canonicalization).',
      step_3: 'Compute SHA-256 hash of the JSON string.',
      step_4: 'Compare with the `manifestHash` stored in the ERC-1155 token.',
    }
  },
  zh: {
    nav: {
      market: '市场',
      quote: '报价',
      ledger: '账本',
      uplink: '接入',
      docs: '文档',
      connect: '连接钱包',
      status_live: '实时链路在线',
      status_mock: '演示模式 (无后端)',
      status_conn: '连接中...',
      login: '身份登录',
      logout: '断开连接',
      profile: '操作员 ID',
    },
    auth: {
      title_login: '身份验证',
      title_signup: '新操作员注册',
      email: '通讯邮箱',
      password: '访问密钥',
      btn_login: '建立连接',
      btn_signup: '注册上行链路',
      toggle_login: '已有 ID? 登录',
      toggle_signup: '需要访问权限? 申请 ID',
      error: '访问被拒绝',
      success: '连接已建立',
      loading: '握手中...',
    },
    hero: {
      badge: '协议 V2 现已在主网上线',
      title_1: '机器人作业',
      title_2: '通证化',
      subtitle: '自主智能体的结算层。我们要做的不仅仅是租赁硬件，而是通过密码学验证物理结果，让您购买确定的成果。',
      btn_connect: '接入机器人',
      btn_market: '浏览市场',
      btn_docs: '开发者 / 协议',
      stat_gmv: '交易总额 (30天)',
      stat_active: '活跃报单',
      stat_settled: '已结算',
      stat_security: '安全性',
      stat_uptime: 'SLA 在线率',
    },
    features: {
      title: '密码学确定性',
      subtitle: '用数学证明取代信任。',
      card_1_title: '验证执行',
      card_1_desc: '机器人使用安全飞地密钥对遥测数据签名。执行清单（ExecutionManifests）被哈希并锚定在链上，形成不可篡改的历史。',
      card_2_title: '流动性凭证',
      card_2_desc: '完成的任务将铸造 ERC-1155 代币。这些收据是可组合的 DeFi 资产，可用于保理、审计或交易。',
      card_3_title: '服务原语',
      card_3_desc: '用于巡检、巡逻和配送的标准化接口。与任何支持 ROS 的硬件即插即用兼容。',
    },
    live: {
      title: '实时结算日志.log',
      view_explorer: '查看浏览器',
    },
    cta: {
      title: '开始购买成果。',
      subtitle: '立即加入自主运营商和服务购买者的网络。',
      btn_quote: '获取报价',
      btn_docs: '阅读文档',
    },
    market: {
      title: '全球市场',
      source_live: '数据源: 实时节点',
      source_mock: '数据源: 模拟数据',
      tab_all: '全部',
      search_placeholder: '搜索坐标...',
      col_id: 'ID',
      col_type: '类型',
      col_loc: '位置',
      col_qual: '质量',
      col_price: '价格',
      empty: '网络上暂无广播的报单。',
      init: '正在初始化数据流...',
      btn_exec: '执行',
    },
    connect: {
      title: '硬件上行链路',
      subtitle: '用于自主资产的通用连接协议。',
      section_onboard: '生产上行链路',
      onboard_desc: '注册新舰队以生成生产 API 密钥。',
      fleet_name: '舰队名称 / 呼号',
      btn_onboard: '初始化并生成密钥',
      redirecting: '正在重定向至安全网关...',
      section_sim: '上行链路模拟器 (测试网)',
      endpoint_label: '目标端点 (POST)',
      payload_label: '载荷配置',
      btn_transmit: '启动序列',
      btn_transmitting: '传输中...',
      terminal_title: '终端输出',
      log_init: '> 系统初始化...',
      log_wait: '> 等待载荷...',
      log_encrypt: '> 数据包加密中... [OK]',
      log_handshake: '> 与 VRWX 节点握手...',
      log_upload: '> 上传遥测数据...',
      log_confirm: '> 200 OK: 已确认',
      log_mint: '> 凭证铸造成功。',
      log_close: '> 会话关闭。',
      signal_lock: '信号锁定',
      no_carrier: '无载波',
    },
    quote: {
      title: '任务配置',
      subtitle: '定义参数 // 估算成本 // 部署',
      step_1: '1. 选择服务类型',
      step_2: '2. 任务参数',
      label_zone: '目标区域',
      label_duration: '时长 (小时)',
      label_sla: 'SLA 等级',
      cost_title: '成本分析',
      wait_input: '[等待输入]',
      total_est: '总估算',
      base_rate: '基础费率',
      quality_mult: '质量系数',
      bonding_title: '需要托管保证金',
      bonding_desc: '质押: ${amount}。在结果验证后退还。',
      btn_sign: '签名并部署',
      btn_done: '报单已上链',
      offer_confirmed: 'TX: 0x9f...2a1 [已确认]',
      view_etherscan: '查看 ETHERSCAN',
    },
    receipts: {
      title: '凭证浏览器',
      subtitle: '所有已验证机器人成果的公共账本。',
      btn_csv: '下载 CSV',
      col_token: '代币 ID',
      col_service: '服务',
      col_op: '运营商',
      col_time: '时间',
      col_status: '状态',
      col_val: '价值',
      detail_return: '返回浏览器',
      detail_settlement: '结算价值',
      detail_manifest: '执行清单',
      detail_proof: '密码学证明',
      detail_chain: '链上锚点 (不可篡改)',
      verify_btn: '重新计算哈希并验证',
      verify_hashing: '1/2 正在重新计算本地哈希...',
      verify_server: '2/2 正在查询链上节点...',
      verify_success_title: '双重匹配确认',
      verify_local_match: '本地重算匹配',
      verify_server_match: '服务器验证通过',
      verify_reset: '重置验证器',
    },
    community: {
      title: '网络状态',
      subtitle: '去中心化运营商注册表 & 节点遥测',
      label_gmv: '总交易量 (GMV)',
      label_receipts: '总凭证数',
      stat_active: '活跃报单',
      stat_active_sub: '实时服务列表',
      stat_dispute: '争议率',
      stat_dispute_sub: '网络健康检查',
      stat_uptime: '在线率',
      stat_uptime_sub: '过去 30 天',
      topology: '全球节点拓扑',
      sync_live: '实时同步',
      sync_conn: '连接中',
    },
    docs: {
      title: '开发者中心',
      subtitle: '用于将自主智能体与 VRWX 结算协议集成的技术资源。',
      sdk_ref: 'SDK 参考',
      smart_contracts: '智能合约',
      core_concepts: '核心概念',
      link_webhook: 'Webhook 集成',
      link_proof: '证明验证',
      link_manifest: '服务清单',
      api_key_title: '需要 API 密钥？',
      api_key_desc: '访问主网中继需要一个已质押的运营商账户。',
      apply_access: '申请访问',
      section_webhook: 'Webhook 集成',
      webhook_desc: '机器人通过标准 Webhook 将作业完成数据推送到 VRWX 中继。中继处理 IPFS 固定和链上哈希（铸造）。',
      section_proof: '证明验证',
      proof_desc: '为了在不信任 API 的情况下验证收据，请在本地重新计算哈希。',
      step_1: '从 IPFS 获取规范 JSON（通过 `manifestUrl`）。',
      step_2: '递归排序对象键（规范化）。',
      step_3: '计算 JSON 字符串的 SHA-256 哈希。',
      step_4: '与存储在 ERC-1155 代币中的 `manifestHash` 进行比较。',
    }
  }
};

const LanguageContext = createContext<{ lang: Language; setLang: (l: Language) => void; t: typeof translations['en'] } | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [lang, setLang] = useState<Language>('en');
  
  return (
    <LanguageContext.Provider value={{ lang, setLang, t: translations[lang] }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};

// Helper to translate service types and status from data
export const translateServiceType = (type: string, lang: Language) => {
  if (lang === 'en') return type;
  const map: Record<string, string> = {
    'inspection': '巡检',
    'patrol': '巡逻',
    'delivery': '配送',
    'Visual Inspection': '视觉巡检',
    'Perimeter Patrol': '周边巡逻',
    'Secure Delivery': '安全配送',
    'settled': '已结算',
    'minted': '已铸造',
    'disputed': '有争议'
  };
  return map[type] || type;
};
